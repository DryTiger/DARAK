<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title> DARAK </title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;700&family=Orbitron:wght@400;700&display=swap"
    rel="stylesheet">
  <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container">
    <h1> DARAK </h1>
    <p class="subtitle">A room for your memories</p>
    <h2 id="pageTitle"
      style="color: var(--accent-neon-blue); margin-top: 10px; font-size: 1.5em; text-transform: uppercase; font-family: 'Orbitron', sans-serif; height: 1.5em;">
    </h2>


    <div class="calendar-header">
      <div class="month-nav">
        <button class="nav-button" onclick="changeMonth(-1)">&lt;</button>
        <div class="month-year" id="monthYear">2025ÎÖÑ 1Ïõî</div>
        <button class="nav-button" onclick="changeMonth(1)">&gt;</button>
      </div>
      <div class="category-tabs">
        <div class="category-tab active">ÏòÅÌôî</div>
        <div class="category-tab">Ï±Ö</div>
        <div class="category-tab">ÎìúÎùºÎßà</div>
        <div class="category-tab">Í≥µÏó∞</div>
        <div class="category-tab">Ï†ÑÏãú</div>
        <div class="category-tab">+</div>
        <div class="category-tab edit-mode-btn" onclick="toggleCategoryEdit()" title="Remove Category">‚úé</div>
      </div>
    </div>

    <!-- Main Views -->
    <!-- ... skipping middle ... -->

    <!-- Main Views -->

    <!-- Main Views -->
    <div id="calendarView" class="view-section active">
      <div class="calendar-grid">
        <div class="day-header weekend">Ïùº</div>
        <div class="day-header">Ïõî</div>
        <div class="day-header">Ìôî</div>
        <div class="day-header">Ïàò</div>
        <div class="day-header">Î™©</div>
        <div class="day-header">Í∏à</div>
        <div class="day-header weekend">ÌÜ†</div>
        <!-- Days will be generated by JS -->
      </div>
    </div>

    <!-- List View Added -->
    <div id="listView" class="view-section" style="display: none;">
      <div class="list-container" id="recordListContainer">
        <!-- List items will be generated here -->
      </div>
    </div>

    <div id="bucketView" class="view-section" style="display: none;">
      <h2 class="month-year">Bucket List</h2>
      <div class="bookshelf" id="bookshelfContainer">
        <!-- Shelves will be generated here -->
      </div>
    </div>

    <!-- Stats View -->
    <div id="statsView" class="view-section" style="display: none;">
      <h3 class="month-year">Statistics</h3>
      <div class="view-content">
        <div class="stats-dashboard">

          <!-- Card 1: Total Memories (Full Width) -->
          <div class="stat-card span-2" style="text-align: center; padding: 20px;">
            <h4 style="margin-bottom: 10px;">TOTAL MEMORIES</h4>
            <div class="stat-big-number neon-blue" id="statTotalCount">0</div>
          </div>

          <!-- Card 2: By Category -->
          <div class="stat-card">
            <h4>By Category</h4>
            <div class="stat-list" id="statCategoryList"></div>
          </div>

          <!-- Card 3: Top 3 Favorites -->
          <div class="stat-card">
            <h4>Top 3 Favorites</h4>
            <div id="statTop3List"></div>
          </div>

          <!-- Card 4: Rating Distribution -->
          <div class="stat-card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <h4>Rating Distribution</h4>
              <div id="statAvgDisplay" class="stat-avg-display"></div>
            </div>
            <div class="stat-graph" id="statRatingGraph"></div>
          </div>

          <!-- Card 5: Mind Map -->
          <div class="stat-card">
            <h4>Keywords</h4>
            <div id="statMindMap" class="mindmap-container"></div>
          </div>

        </div>
      </div>
    </div>

    <!-- Ticket Gallery View -->
    <!-- Ticket Wall View (Renamed to match script and optimized structure) -->
    <div id="ticketWallView" class="view-section" style="display: none;">
      <h2 class="month-year">Ticket Archive</h2>
      <div id="ticketWallContainer" class="ticket-wall-container">
        <!-- Saved tickets shown here -->
      </div>
    </div>

    <!-- Settings View (New) -->
    <div id="settingsView" class="view-section" style="display: none;">
      <h2 class="month-year">Settings</h2>
      <div class="view-content" style="padding: 20px; color: var(--text-main);">

        <div class="settings-card"
          style="background: rgba(0,0,0,0.5); padding: 20px; border-radius: 12px; border: 1px solid var(--glass-border); margin-bottom: 20px;">
          <h3 style="color: var(--accent-neon-blue); margin-bottom: 15px;">Data Management</h3>
          <p style="margin-bottom: 15px; color: #aaa;">Export your data for backup or restore it from a previous save.
          </p>

          <div style="display: flex; gap: 10px;">
            <button class="save-btn" onclick="window.exportJSON()" style="margin: 0; flex: 1;">
              Export Data (JSON)
            </button>
            <button class="save-btn" onclick="document.getElementById('importFileSetting').click()"
              style="margin: 0; flex: 1; background: var(--accent-gold); color: #000;">
              Import Data
            </button>
            <input type="file" id="importFileSetting" style="display: none;" accept=".json"
              onchange="window.importJSON(event)">
          </div>
        </div>

        <div class="settings-card"
          style="background: rgba(0,0,0,0.5); padding: 20px; border-radius: 12px; border: 1px solid var(--glass-border);">
          <h3 style="color: var(--accent-gold); margin-bottom: 15px;">About</h3>
          <p style="color: #aaa;">DARAK: A room for your memories.</p>
          <p style="color: #666; font-size: 0.8em; margin-top: 10px;">Version 1.2.0 (IndexedDB Enabled)</p>
        </div>

      </div>
    </div>
  </div>

  <!-- Floating Sidebar -->
  <div class="floating-sidebar">
    <button class="sidebar-btn active" onclick="switchView('calendar')" title="Home">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
    </button>
    <button class="sidebar-btn" onclick="switchView('list')" title="List View">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="8" y1="6" x2="21" y2="6"></line>
        <line x1="8" y1="12" x2="21" y2="12"></line>
        <line x1="8" y1="18" x2="21" y2="18"></line>
        <line x1="3" y1="6" x2="3.01" y2="6"></line>
        <line x1="3" y1="12" x2="3.01" y2="12"></line>
        <line x1="3" y1="18" x2="3.01" y2="18"></line>
      </svg>
    </button>
    <button class="sidebar-btn" onclick="switchView('bucket')" title="Bucket List">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="9 11 12 14 22 4"></polyline>
        <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
      </svg>
    </button>
    <button class="sidebar-btn" onclick="switchView('stats')" title="Statistics">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="7" height="7"></rect>
        <rect x="14" y="3" width="7" height="7"></rect>
        <rect x="14" y="14" width="7" height="7"></rect>
        <rect x="3" y="14" width="7" height="7"></rect>
      </svg>
    </button>
    <!-- Ticket Gallery Button -->
    <button class="sidebar-btn" onclick="switchView('gallery')" title="Ticket Storage">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M4 6h16v12H4z"></path>
        <line x1="8" y1="6" x2="8" y2="18" stroke-dasharray="2 2"></line>
        <line x1="16" y1="6" x2="16" y2="18" stroke-dasharray="2 2"></line>
      </svg>
    </button>
    <!-- Settings Button -->
    <button class="sidebar-btn" onclick="switchView('settings')" title="Settings">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"></circle>
        <path
          d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
        </path>
      </svg>
    </button>
  </div>

  <!-- Modal Structure -->
  <div class="modal-overlay" id="recordModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">Record</div>
        <button class="close-btn" type="button" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body" id="modalBody">
        <form class="record-form" id="recordForm" onsubmit="saveRecord(event)">
          <!-- Title Section Redesigned -->
          <div class="form-group title-group">
            <input type="text" class="form-input title-input" id="recordTitle" placeholder="Enter Title Here">
          </div>

          <div class="form-group">
            <label class="form-label">Date</label>
            <input type="date" class="form-input" id="recordDate" required readonly>
          </div>

          <div class="form-group">
            <label class="form-label">Category</label>
            <select class="form-select" id="recordCategory" onchange="updateCategoryFields()">
              <option value="ÏòÅÌôî">ÏòÅÌôî</option>
              <option value="Ï±Ö">Ï±Ö</option>
              <option value="ÎìúÎùºÎßà">ÎìúÎùºÎßà</option>
              <option value="Í≥µÏó∞">Í≥µÏó∞</option>
              <option value="Ï†ÑÏãú">Ï†ÑÏãú</option>
              <option value="Í∏∞ÌÉÄ">Í∏∞ÌÉÄ</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">Image</label>
            <div class="image-mode-tabs">
              <button type="button" class="mode-tab active" onclick="switchImageMode('upload')">Upload</button>
              <button type="button" class="mode-tab" onclick="switchImageMode('search')">Search Web</button>
            </div>

            <div id="imageUploadSection">
              <div class="image-upload-wrapper">
                <input type="file" id="recordImage" accept="image/*" onchange="handleImageUpload(event)" hidden>
                <label for="recordImage" class="custom-file-upload btn-style">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                  </svg>
                  <span>Upload Image</span>
                </label>
              </div>
            </div>

            <div id="imageSearchSection" style="display: none;">
              <div class="search-box">
                <input type="text" id="imgSearchInput" class="form-input" placeholder="Search for posters">
                <button type="button" class="search-go-btn" onclick="searchImages()">Go</button>
              </div>
              <div id="imgSearchResults" class="search-results-grid"></div>
            </div>

            <img id="imagePreview" class="image-preview">
          </div>

          <!-- OST Section Redesigned -->
          <div class="form-group">
            <label class="form-label">Music / Soundtrack</label>
            <div class="image-mode-tabs">
              <button type="button" class="mode-tab active" onclick="switchOstMode('url')">URL / Upload</button>
              <button type="button" class="mode-tab" onclick="switchOstMode('search')">Search YouTube</button>
            </div>

            <div id="ostUrlSection">
              <div class="ost-inputs">
                <input type="text" class="form-input" id="recordYoutube" placeholder="Paste YouTube URL">
                <input type="file" id="recordAudio" accept="audio/*" hidden onchange="handleAudioUpload(event)">
                <label for="recordAudio" class="custom-file-upload small-upload btn-style">
                  <span>Upload Music</span>
                </label>
              </div>
            </div>

            <div id="ostSearchSection" style="display: none;">
              <div class="search-box">
                <input type="text" id="ytSearchInput" class="form-input" placeholder="Search for music">
                <button type="button" class="search-go-btn" onclick="searchYoutube()">Go</button>
              </div>
              <div id="ytSearchResults" class="search-results-grid" style="grid-template-columns: 1fr; gap: 5px;"></div>
            </div>

            <div id="ostPreview" class="ost-preview"></div>
          </div>

          <div id="dynamicFields" class="dynamic-fields"></div>

          <div class="form-group">
            <label class="form-label">Location</label>
            <div class="tag-container" id="tags_location">
              <button type="button" class="add-tag-btn" onclick="addTag('location')">+</button>
            </div>
            <input type="hidden" id="recordLocation" class="dynamic-input">
          </div>

          <div class="form-group">
            <label class="form-label">Rating</label>
            <div class="star-rating" id="starRating">
              <span class="star" onclick="setRating(1)">‚òÖ</span>
              <span class="star" onclick="setRating(2)">‚òÖ</span>
              <span class="star" onclick="setRating(3)">‚òÖ</span>
              <span class="star" onclick="setRating(4)">‚òÖ</span>
              <span class="star" onclick="setRating(5)">‚òÖ</span>
            </div>
            <input type="hidden" id="ratingValue" value="0">
          </div>

          <div class="form-group">
            <label class="form-label">Mood</label>
            <div class="mood-selector" id="moodSelector">
              <span class="mood-option" data-value="happy" onclick="setMood('happy')" title="Happy">üòä</span>
              <span class="mood-option" data-value="excited" onclick="setMood('excited')" title="Excited">ü§©</span>
              <span class="mood-option" data-value="relaxed" onclick="setMood('relaxed')" title="Relaxed">üòå</span>
              <span class="mood-option" data-value="sad" onclick="setMood('sad')" title="Sad">üò¢</span>
              <span class="mood-option" data-value="angry" onclick="setMood('angry')" title="Angry">üò°</span>
            </div>
            <input type="hidden" id="recordMood">
          </div>

          <div class="form-group">
            <label class="form-label">Review</label>
            <textarea class="form-textarea auto-expand" id="recordReview" rows="3"></textarea>
          </div>

          <input type="hidden" id="recordId">

          <div class="modal-footer" style="display: flex; gap: 10px; margin-top: 20px;">
            <button type="button" class="delete-btn" onclick="deleteCurrentRecord()"
              style="background: #e53e3e; color: white; border: none; padding: 15px; border-radius: 10px; flex: 1; display: none;"
              id="btnDelete">Delete</button>
            <button type="button" class="ticket-btn" onclick="downloadTicket()"
              style="background: var(--accent-gold); color: #000; border: none; padding: 15px; border-radius: 10px; flex: 1; font-weight:700;">Ticket</button>
            <button type="submit" class="save-btn" style="flex: 2; margin-top: 0;">Save Record</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Daily List Modal -->
  <div class="modal-overlay" id="dailyListModal">
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header">
        <div class="modal-title" id="dailyListDate">Date</div>
        <button class="close-btn" onclick="closeDailyList()">&times;</button>
      </div>
      <div class="modal-body" id="dailyListBody">
        <!-- List items start -->
        <!-- Items inserted by JS -->
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header">
        <div class="modal-title">Settings</div>
        <button class="close-btn" onclick="closeSettings()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Data Management</label>
          <div style="display: flex; gap: 10px; margin-bottom: 20px;">
            <button class="save-btn" onclick="exportJSON()" style="flex:1;">Backup Data (JSON)</button>
            <button class="ticket-btn" onclick="document.getElementById('importFile').click()"
              style="flex:1; background: #333; color: white;">Restore Data</button>
            <input type="file" id="importFile" accept=".json" style="display:none;" onchange="importJSON(event)">
          </div>
        </div>
        <div class="form-group" style="opacity: 0.5; pointer-events: none;">
          <label class="form-label">API Configuration (Built-in)</label>
          <input type="text" class="form-input" value="API Keys are integrated." readonly>
        </div>
        <!-- <button class="save-btn" onclick="saveSettings()">Save Configuration</button> -->
      </div>
    </div>
  </div>

  <!-- Ticket Export Template (Hidden/Off-screen) -->
  <div id="ticket-export-view" class="ticket-visual" style="position: absolute; left: -9999px; top: 0;">
    <div class="ticket-header">
      <img id="ticketImage" class="ticket-img">
      <div class="ticket-overlay"></div>
    </div>
    <div class="ticket-body">
      <div class="ticket-date" id="ticketDate">2025.12.25</div>
      <h1 class="ticket-title" id="ticketTitle">Movie Title</h1>
      <div class="ticket-meta">
        <span id="ticketCategory">MOVIE</span> ‚Ä¢ <span id="ticketRating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
      </div>
      <div class="ticket-location" id="ticketLocation">@ Home</div>
      <div class="ticket-barcode">
        <div class="barcode-lines"></div>
        <span class="ticket-id">NO. 0029384</span>
      </div>
    </div>
    <div class="ticket-rip"></div>
  </div>


  <!-- Custom Retro Confirm/Alert Modal -->
  <div class="modal-overlay" id="customPopup">
    <div class="modal-content retro-popup" style="max-width: 400px; text-align: center;">
      <h3 id="popupTitle" style="color: var(--accent-gold); margin-bottom: 15px;">ALERT</h3>
      <p id="popupMessage" style="margin-bottom: 20px; font-size: 1.1em;"></p>
      <input type="text" id="popupInput" class="form-input" style="display:none; margin-bottom: 20px;">
      <div class="popup-buttons">
        <button id="popupCancel" class="delete-btn" style="padding: 10px 20px; border-radius: 8px;">Cancel</button>
        <button id="popupOk" class="save-btn" style="margin: 0; padding: 10px 20px; border-radius: 8px;">OK</button>
      </div>
    </div>
  </div>

  <!-- Bucket List Action Modal -->
  <div class="modal-overlay" id="bucketActionModal">
    <div class="modal-content retro-popup" style="max-width: 400px; text-align: center;">
      <h3 id="bucketActionTitle" style="color: var(--accent-gold); margin-bottom: 20px;">BOOK TITLE</h3>
      <div class="popup-buttons vertical">
        <button onclick="handleBucketAction('review')" class="save-btn" style="width:100%; margin-bottom:10px;">Write
          Review</button>
        <button onclick="handleBucketAction('delete')" class="delete-btn"
          style="width:100%; margin-bottom:10px; background:#9d9d9d;">Remove</button>
        <button onclick="closeBucketAction()" class="cancel-btn" style="width:100%; border-radius:8px;">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Bucket List Add Modal -->
  <div class="modal-overlay" id="bucketAddModal">
    <div class="modal-content retro-popup" style="max-width: 500px;">
      <h3 style="color: var(--accent-neon-blue); text-align: center; margin-bottom: 20px;">Add to Bucket List
      </h3>

      <div class="form-group">
        <label class="form-label">Title</label>
        <input type="text" id="bucketAddTitle" class="form-input title-input" placeholder="What do you want to see?">
      </div>

      <div class="form-group">
        <label class="form-label">Category</label>
        <div class="category-filter-container" id="bucketAddCategoryContainer">
          <!-- Buttons generated by JS -->
        </div>
        <input type="hidden" id="bucketAddCategory">
      </div>

      <div class="popup-buttons">
        <button onclick="closeBucketAdd()" class="delete-btn" style="padding:10px 20px;">Cancel</button>
        <button onclick="confirmBucketAdd()" class="save-btn" style="margin:0; padding:10px 20px;">Add
          Item</button>
      </div>
    </div>
  </div>



  <!-- Add Category Modal (Standardized) -->
  <div class="modal-overlay" id="addCategoryModal" style="z-index: 2147483647 !important;">
    <div class="modal-content retro-popup" style="max-width: 400px; text-align: center;">
      <h3 style="color: var(--accent-neon-blue); margin-bottom: 25px;">Add New Category</h3>
      <input type="text" id="newCategoryInput" class="form-input title-input" placeholder="Category Name"
        style="margin-bottom: 20px; width: 100%;">
      <div class="popup-buttons vertical">
        <button onclick="confirmAddCategory()" class="save-btn"
          style="width: 100%; margin-bottom: 10px;">Create</button>
        <button onclick="closeAddCategoryModal()" class="cancel-btn" style="width: 100%;">Cancel</button>
      </div>
    </div>
  </div>

  </div>
  </div>
  </div>

  <!-- Import Options Modal -->
  <div class="modal-overlay" id="importOptionsModal" style="z-index: 2147483647 !important;">
    <div class="modal-content retro-popup"
      style="max-width: 450px; text-align: center; border: 1px solid var(--accent-neon-blue);">
      <h3 style="color: var(--accent-neon-blue); margin-bottom: 20px;">Import Data Options</h3>
      <p style="color: #ccc; margin-bottom: 25px;">How would you like to handle the imported data?</p>

      <div class="popup-buttons vertical" style="gap: 15px;">
        <button onclick="confirmImport('merge')" class="save-btn"
          style="width: 100%; background: linear-gradient(135deg, #1cb5e0, #000851);">
          <strong>Merge (Recommend)</strong><br>
          <span style="font-size: 0.8em; font-weight: normal; opacity: 0.8;">Keep existing data, add new items.
            safe.</span>
        </button>

        <button onclick="confirmImport('replace')" class="save-btn"
          style="width: 100%; background: linear-gradient(135deg, #ff2a6d, #b00e3a); box-shadow: 0 4px 15px rgba(255,42,109,0.3);">
          <strong>Replace All</strong><br>
          <span style="font-size: 0.8em; font-weight: normal; opacity: 0.8;">‚ö†Ô∏è Overwrite current data
            completely.</span>
        </button>

        <button onclick="closeImportOptions()" class="cancel-btn" style="width: 100%;">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Ticket Preview Modal -->
  <div class="modal-overlay" id="ticketPreviewModal">
    <div class="modal-content retro-popup" style="max-width: 450px; text-align: center; padding: 30px !important;">
      <h3 style="color: var(--accent-neon-blue); margin-bottom: 20px;">Ticket Generated</h3>
      <div id="ticketPreviewContainer"
        style="margin-bottom: 20px; border: 2px solid #555; border-radius: 8px; overflow: hidden;">
        <!-- Image injected here -->
      </div>
      <div class="popup-buttons vertical" style="display: flex; flex-direction: column; gap: 10px; width: 100%;">
        <button id="btnDownloadTicket" class="save-btn" style="width: 100%;">Download Image</button>
        <button id="btnSaveToWall" class="save-btn"
          style="width: 100%; background: var(--accent-gold); color: #000;">Add to Ticket Wall</button>
        <button onclick="document.getElementById('ticketPreviewModal').classList.remove('active')" class="cancel-btn"
          style="width: 100%;">Close</button>
      </div>
    </div>
  </div>



  <!-- Ticket HTML Template (Hidden) -->
  <div id="ticketView" class="ticket-view">
    <!-- Clip-path handles edges now -->

    <div class="ticket-content-overlay">
      <div class="ticket-header-overlay">
        <span class="ticket-brand">DARAK ORIGINAL TICKET</span>
        <span class="ticket-year" id="ticketYear">2024</span>
      </div>

      <div class="ticket-main-info">
        <h2 id="ticketTitle">TITLE</h2>
        <div class="ticket-rating-stars" id="ticketRating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
      </div>

      <div class="ticket-details-grid">
        <div class="ticket-detail-item">
          <label>DATE</label>
          <span id="ticketDate">2024.05.20</span>
        </div>
        <div class="ticket-detail-item">
          <label>CATEGORY</label>
          <span id="ticketCategory">MOVIE</span>
        </div>
        <div class="ticket-detail-item full-width">
          <label>REVIEW</label>
          <span id="ticketReview" class="review-text">Review text...</span>
        </div>
      </div>

      <div class="ticket-footer-bar">
        <span>COLLECT YOUR MOMENTS</span>
        <span class="barcode-font">||| ||| || |||</span>
      </div>
    </div>
  </div>

  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <script src="script.js?v=999"></script>
</body>

</html>